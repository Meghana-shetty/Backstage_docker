apiVersion: scaffolder.backstage.io/v1beta3
kind: Template
metadata:
  name: docker-deploy-from-github
  title: Deploy Docker from GitHub Repo
  description: Create and deploy a Docker container from a GitHub repository URL.
spec:
  owner: user:guest
  type: service
  parameters:
    - title: GitHub Repository URL
      type: string
      name: repoUrl
  steps:
    - id: clone
      name: Clone Repository
      action: github:clone
      input:
        url: ${{ parameters.repoUrl }}

    - id: build_docker
      name: Build Docker Image
      action: shell:run
      input:
        workingDirectory: ${{ steps.clone.output.path }}
        script: |
          docker build -t my-image:latest .

    - id: deploy_docker
      name: Deploy Docker Container
      action: shell:run
      input:
        workingDirectory: ${{ steps.clone.output.path }}
        script: |
          docker run -d -p 8080:80 my-image:latest
